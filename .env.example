# =============================================================================
# MangwaleAI Monorepo — Environment Variables Template
# Copy to the relevant .env file and fill in actual values:
#   backend/.env          (NestJS backend)
#   frontend/.env.local   (Next.js frontend — use NEXT_PUBLIC_ vars)
#   search/.env           (Search stack)
# =============================================================================

# =============================================================================
# BACKEND (NestJS — port 3200)
# =============================================================================

COMPOSE_PROJECT_NAME=mangwale-ai
NODE_ENV=development
PORT=3200
APP_NAME=Mangwale AI
TEST_MODE=false
TZ=Asia/Kolkata

# WhatsApp Business API
WHATSAPP_PHONE_NUMBER_ID=
WHATSAPP_ACCESS_TOKEN=
WHATSAPP_VERIFY_TOKEN=
WHATSAPP_APP_SECRET=
WHATSAPP_API_VERSION=v24.0

# WhatsApp Flows (create in Meta WhatsApp Manager)
WA_FLOW_ADDRESS_ID=           # Flow ID for address selection form
WA_FLOW_PAYMENT_ID=           # Flow ID for payment method selection
WA_FLOW_CUSTOMIZATION_ID=     # Flow ID for item customization

# Telegram Bot
TELEGRAM_BOT_TOKEN=

# Instagram DM (conditional — module loads only if token is set)
INSTAGRAM_ACCESS_TOKEN=
INSTAGRAM_VERIFY_TOKEN=

# PHP Laravel Backend
PHP_API_BASE_URL=https://new.mangwale.com
PHP_BACKEND_URL=https://new.mangwale.com
PHP_API_TIMEOUT=30000

# PostgreSQL (NestJS own database)
DATABASE_URL=postgresql://mangwale_config:<PASSWORD>@localhost:5432/headless_mangwale?schema=public

# MySQL (PHP backend — READ-ONLY access)
MYSQL_HOST=<PHP_SERVER_IP>
MYSQL_PORT=3307
MYSQL_DATABASE=mangwale_db
MYSQL_USER=readonly
MYSQL_PASSWORD=

# Redis
REDIS_HOST=localhost
REDIS_PORT=6381
REDIS_PASSWORD=
REDIS_DB=1

# Session & OTP
SESSION_TTL=86400
OTP_TTL=600
OTP_LENGTH=6

# Module defaults
DEFAULT_PARCEL_MODULE_ID=3

# Logging & Debug
LOG_LEVEL=debug
DEBUG_NLU=true
DEBUG_LLM=true
DEBUG_FLOW=true
DEBUG_SEARCH=true

# Flow Engine
FLOW_SOURCE=yaml
FLOW_HOT_RELOAD=true

# NLU (IndicBERTv2 on Mercury GPU)
NLU_AI_ENABLED=true
NLU_PRIMARY_ENDPOINT=http://192.168.0.151:7012
NLU_MODEL_NAME=ai4bharat/IndicBERTv2-MLM-only
INTENT_MODEL_PATH=/models/nlu_production
NLU_CONFIDENCE_THRESHOLD=0.65
NLU_TIMEOUT=5000

# NER (MuRIL on Mercury GPU)
NER_SERVICE_URL=http://192.168.0.151:7011

# Training Server (Mercury)
TRAINING_SERVER_URL=http://192.168.0.151:8082

# Search API
SEARCH_API_URL=http://localhost:3100
SEARCH_SERVICE_URL=http://localhost:3100
OPENSEARCH_URL=http://localhost:9200
EMBEDDING_SERVICE_URL=http://localhost:3101

# Cloud LLM Providers
GROQ_API_KEY=
OPENROUTER_API_KEY=
OPENAI_API_KEY=
DEEPSEEK_API_KEY=
TOGETHER_API_KEY=
HUGGINGFACE_API_KEY=
ANTHROPIC_API_KEY=

# vLLM (local Qwen2.5-7B)
LLM_MODE=hybrid
VLLM_MODEL=Qwen/Qwen2.5-7B-Instruct-AWQ
DEFAULT_LLM_PROVIDER=vllm
DEFAULT_CLOUD_PROVIDER=auto
VLLM_URL=http://localhost:8002
VLLM_CHAT_ENDPOINT=http://localhost:8002/v1/chat/completions

# Voice Services (Mercury)
ASR_SERVICE_URL=http://192.168.0.151:7001
TTS_SERVICE_URL=http://192.168.0.151:7002
VOICE_ORCHESTRATOR_URL=http://192.168.0.151:7000

# Storage / CDN
STORAGE_CDN_URL=https://storage.mangwale.ai/mangwale/product
S3_BASE_URL=https://mangwale.s3.ap-south-1.amazonaws.com/product

# Geo defaults
DEFAULT_CITY=Nashik
DEFAULT_STATE=Maharashtra
DEFAULT_LATITUDE=19.9975
DEFAULT_LONGITUDE=73.7898

# Tracking
TRACKING_BASE_URL=https://track.mangwale.in

# Messaging
FORCE_SESSION_PLATFORM=true

# CORS
ADDITIONAL_CORS_ORIGINS=

# Pricing
PLATFORM_FEE=5
FOOD_GST_RATE=0.05
PARCEL_GST_RATE=0.18
DEFAULT_DELIVERY_FEE_PER_KM=10
DEFAULT_MIN_DELIVERY_FEE=30
PARCEL_PER_KM_RATE=11.11
PARCEL_MIN_CHARGE=44
ECOM_SHIPPING_FEE=40
ECOM_FREE_SHIPPING_THRESHOLD=500

# Training thresholds
TRAINING_CONFIDENCE_HIGH=0.85
TRAINING_CONFIDENCE_MEDIUM=0.70
TRAINING_PRIORITY_HIGH=2
TRAINING_PRIORITY_MEDIUM=5
TRAINING_PRIORITY_LOW=10
TRAINING_DEFAULT_QUALITY_SCORE=0.9

# App secrets
JWT_SECRET=
SESSION_SECRET=
FRAPPE_BASE_URL=
FRAPPE_API_KEY=
FRAPPE_API_SECRET=

# =============================================================================
# FRONTEND (Next.js)
# =============================================================================

NEXT_PUBLIC_ADMIN_BACKEND_URL=/api
NEXT_PUBLIC_MANGWALE_AI_URL=/api
NEXT_PUBLIC_PHP_BACKEND_URL=http://localhost:8090
NEXT_PUBLIC_API_URL=/api
NEXT_PUBLIC_WS_URL=/

NEXTAUTH_URL=https://your-domain.com
NEXTAUTH_SECRET=

NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=
NEXT_PUBLIC_GOOGLE_CLIENT_ID=
NEXT_PUBLIC_FACEBOOK_APP_ID=
NEXT_PUBLIC_APPLE_CLIENT_ID=

NEXT_PUBLIC_ENABLE_VOICE=true
NEXT_PUBLIC_ENABLE_SEARCH=true
NEXT_PUBLIC_ENABLE_TRAINING=true
NEXT_PUBLIC_ANALYTICS_ENABLED=false

NEXT_PUBLIC_RAZORPAY_KEY_ID=
NEXT_PUBLIC_PHP_API_BASE_URL=https://new.mangwale.com
NEXT_PUBLIC_SEARCH_API_URL=http://localhost:3100
NEXT_PUBLIC_OSRM_URL=http://localhost:5000
NEXT_PUBLIC_IMAGE_AI_URL=http://localhost:3000

# =============================================================================
# SEARCH STACK (NestJS — port 3100)
# =============================================================================

# OpenSearch
OPENSEARCH_HOST=http://search-opensearch:9200
OPENSEARCH_USERNAME=
OPENSEARCH_PASSWORD=

# Kafka (Redpanda)
KAFKA_BROKERS=search-redpanda:9092

# Redis (Search)
ENABLE_SEARCH_CACHE=true

# ClickHouse (Analytics)
CLICKHOUSE_URL=http://search-clickhouse:8123
CLICKHOUSE_HOST=search-clickhouse
CLICKHOUSE_PORT=8123
CLICKHOUSE_PASSWORD=

# Storage / Images
STORAGE_TYPE=s3
S3_BUCKET=mangwale
S3_REGION=ap-south-1
S3_URL=https://mangwale.s3.ap-south-1.amazonaws.com

MINIO_URL=https://storage.your-domain.com
MINIO_BUCKET=mangwale
MINIO_ACCESS_KEY=
MINIO_SECRET_KEY=

IMAGE_PATH_PRODUCT=product
IMAGE_PATH_STORE=store
IMAGE_PATH_STORE_COVER=store/cover
IMAGE_PATH_CATEGORY=category
IMAGE_PATH_DELIVERY_MAN=delivery-man
IMAGE_FALLBACK_ENABLED=true

# Domain (Traefik routing)
DOMAIN=opensearch.your-domain.com

# Feature flags
ENABLE_PERSONALIZATION=true
ENABLE_RERANKER=false
