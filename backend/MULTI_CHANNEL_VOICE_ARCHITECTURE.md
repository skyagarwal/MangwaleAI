# ğŸ¤ Mangwale AI Multi-Channel & Voice Architecture

## Complete System Map: Jupiter + Mercury

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              MANGWALE AI MULTI-CHANNEL STACK                           â”‚
â”‚                                    "Chotu" AI Assistant                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚    CHANNELS     â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚          â”‚          â”‚           â”‚           â”‚          â”‚          â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
   â”‚WhatsApp â”‚ â”‚Telegramâ”‚ â”‚  SMS   â”‚ â”‚  Voice  â”‚ â”‚  Web  â”‚ â”‚Instagramâ”‚ â”‚ Voice  â”‚
   â”‚ Cloud   â”‚ â”‚  Bot   â”‚ â”‚(Exotel)â”‚ â”‚  IVR    â”‚ â”‚Socket â”‚ â”‚  DM     â”‚ â”‚Realtimeâ”‚
   â”‚ API     â”‚ â”‚  API   â”‚ â”‚        â”‚ â”‚(Twilio) â”‚ â”‚ (io)  â”‚ â”‚         â”‚ â”‚(Mercury)â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚          â”‚          â”‚           â”‚          â”‚          â”‚          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           JUPITER (192.168.0.156) - THE BRAIN                           â”‚
â”‚                                   NestJS Backend :3200                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           CHANNEL ROUTING LAYER                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚WhatsAppCloud â”‚ â”‚  Telegram    â”‚ â”‚   Exotel     â”‚ â”‚    Chat      â”‚            â”‚   â”‚
â”‚  â”‚  â”‚ Service      â”‚ â”‚  Service     â”‚ â”‚   Service    â”‚ â”‚   Gateway    â”‚            â”‚   â”‚
â”‚  â”‚  â”‚ (webhook)    â”‚ â”‚  (webhook)   â”‚ â”‚(SMS/Voice)   â”‚ â”‚ (Socket.IO)  â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚         â”‚                â”‚                â”‚                â”‚                     â”‚   â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚  â”‚                                   â”‚                                              â”‚   â”‚
â”‚  â”‚                                   â–¼                                              â”‚   â”‚
â”‚  â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚   â”‚
â”‚  â”‚                     â”‚ ChannelVariantsService     â”‚                               â”‚   â”‚
â”‚  â”‚                     â”‚ - Adapt per channel caps   â”‚                               â”‚   â”‚
â”‚  â”‚                     â”‚ - Button limits, media     â”‚                               â”‚   â”‚
â”‚  â”‚                     â”‚ - Voice â†’ DTMF menus       â”‚                               â”‚   â”‚
â”‚  â”‚                     â”‚ - SMS â†’ 160 char segments  â”‚                               â”‚   â”‚
â”‚  â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚                                                   â”‚
â”‚                                     â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                          AGENT ORCHESTRATION LAYER                               â”‚   â”‚
â”‚  â”‚                                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                   AgentOrchestratorService                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Routes messages to appropriate flows                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Manages conversation context                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Handles user type routing (customer/vendor/driver)                     â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                     â”‚                                            â”‚   â”‚
â”‚  â”‚                                     â–¼                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                     UserTypeRouterService                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Detects user type from phone/context                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Routes: customer â†’ main flows                                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚           vendor â†’ vendor_auth_v1, vendor_orders_v1                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚           driver â†’ delivery_auth_v1, delivery_orders_v1                   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚                                                   â”‚
â”‚                                     â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                              FLOW ENGINE                                         â”‚   â”‚
â”‚  â”‚                         (18 Flows Registered)                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚     TypeScript Flows (13)    â”‚  â”‚        YAML V2 Flows (5)              â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ greeting.flow.ts       â”‚ â”‚  â”‚  â”‚ vendor_auth_v1.yaml              â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ food-order.flow.ts     â”‚ â”‚  â”‚  â”‚ vendor_orders_v1.yaml            â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ parcel-delivery.flow.tsâ”‚ â”‚  â”‚  â”‚ delivery_auth_v1.yaml            â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ ecommerce-order.flow.tsâ”‚ â”‚  â”‚  â”‚ delivery_orders_v1.yaml          â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ local-services.flow.ts â”‚ â”‚  â”‚  â”‚ customer_support_v1.yaml         â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ hyperlocal.flow.ts     â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ auth.flow.ts           â”‚ â”‚  â”‚         â”‚                              â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ order-tracking.flow.ts â”‚ â”‚  â”‚         â–¼                              â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ account.flow.ts        â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ help-faq.flow.ts       â”‚ â”‚  â”‚  â”‚    PhpApiExecutorService         â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ fallback.flow.ts       â”‚ â”‚  â”‚  â”‚  - Maps YAML actions to PHP      â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ game-intro.flow.ts     â”‚ â”‚  â”‚  â”‚  - Vendor login/register         â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ notifications.flow.ts  â”‚ â”‚  â”‚  â”‚  - Order management              â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  - Delivery status updates      â”‚ â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚   â”‚
â”‚  â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                                                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                      YamlV2FlowLoaderService                                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Loads .yaml/.yml from flows/yaml-v2/                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Converts to Flow interface                                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Registers with FlowEngine                                                  â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚                                                   â”‚
â”‚                                     â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                              AI SERVICES                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚     NLU Service :7010   â”‚  â”‚            vLLM Service :8002               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - IndicBERTv2          â”‚  â”‚  - Qwen2.5-7B-Instruct-AWQ                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Intent classificationâ”‚  â”‚  - Complex reasoning                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Entity extraction    â”‚  â”‚  - Multi-turn conversations                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Hindi/Marathi/Englishâ”‚  â”‚  - Context-aware responses                  â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚                                                   â”‚
â”‚                                     â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                              DATA LAYER                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚   PostgreSQL :5432      â”‚  â”‚              Redis :6381                    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Users, Orders        â”‚  â”‚  - Session state                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Vendors, Drivers     â”‚  â”‚  - Message cache                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Conversation logs    â”‚  â”‚  - Rate limiting                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Products, Categories â”‚  â”‚  - Pub/sub events                           â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â”‚ HTTP/WebSocket
                                          â”‚ Jupiter endpoints
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MERCURY (192.168.0.151) - VOICE INFRA                            â”‚
â”‚                                RTX 3060 12GB GPU                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           VOICE ORCHESTRATOR :7000                               â”‚   â”‚
â”‚  â”‚                                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                         main.py (FastAPI)                                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - WebSocket bidirectional audio streaming                               â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - VAD (Voice Activity Detection)                                        â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - Turn-taking management                                                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - Language detection (Devanagari vs Latin script)                       â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                      smart_loop.py                                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  "One talks while other loads" architecture:                             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  1. User speaks â†’ ASR starts                                             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  2. Play acknowledgment immediately (pre-cached)                         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  3. LLM generates response (streaming) â†’ Jupiter                         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  4. TTS converts sentences as they complete                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  5. Audio plays while next sentence synthesizes                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  Pre-cached acknowledgments:                                             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - Hindi: "à¤œà¥€ à¤¹à¤¾à¤, à¤à¤• à¤¸à¥‡à¤•à¤‚à¤¡", "à¤¬à¤¿à¤²à¥à¤•à¥à¤², à¤¦à¥‡à¤–à¤¤à¤¾ à¤¹à¥‚à¤‚"                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - English: "Sure, one moment", "Got it, let me check"                   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - Marathi: "à¤¹à¥‹, à¤à¤• à¤¸à¥‡à¤•à¤‚à¤¦", "à¤¬à¤°à¥‹à¤¬à¤°, à¤¬à¤˜à¤¤à¥‹"                                    â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                     jupiter_client.py                                    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  Connects to Jupiter services:                                           â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - JUPITER_URL: http://192.168.0.156:3200 (Backend)                      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - JUPITER_NLU_URL: http://192.168.0.156:7010 (NLU)                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - JUPITER_LLM_URL: http://192.168.0.156:8002 (vLLM)                      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  Quick local intent classification:                                      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - Greeting, Farewell, Weather, Time â†’ Local (no API)                    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - Order tracking, Status â†’ Jupiter (needs DB)                           â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - Complex queries â†’ Jupiter LLM                                         â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                       session.py                                         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - ConversationSession with message history                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - SessionManager with auto-cleanup                                      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - Keeps last 20 messages per session                                    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  - 300s timeout for inactive sessions                                    â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚                                                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                    â”‚                                 â”‚                                  â”‚
â”‚                    â–¼                                 â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚       ASR SERVICE :7001         â”‚  â”‚           TTS SERVICE :7002                  â”‚  â”‚
â”‚  â”‚                                 â”‚  â”‚                                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚   Faster-Whisper          â”‚  â”‚  â”‚  â”‚        Kokoro-82M (English)            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   large-v3-turbo          â”‚  â”‚  â”‚  â”‚  - Ultra-fast ~50ms latency            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - English (primary)      â”‚  â”‚  â”‚  â”‚  - Local inference on RTX 3060         â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - Auto language detect   â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â”‚  - int8_float16 compute   â”‚  â”‚  â”‚                                              â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚                                 â”‚  â”‚  â”‚    ChatterBox (Hindi/Marathi/Multi)    â”‚ â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚  - 500M params, 24kHz output           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  AI4Bharat IndicConformer â”‚  â”‚  â”‚  â”‚  - Zero-shot voice cloning             â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - Hindi: Devanagari out  â”‚  â”‚  â”‚  â”‚  - Emotion & style control             â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - Marathi: Devanagari    â”‚  â”‚  â”‚  â”‚                                        â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - Native script output   â”‚  â”‚  â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚  CHOTU CHARACTER PRESETS:              â”‚ â”‚  â”‚
â”‚  â”‚                                 â”‚  â”‚  â”‚  - "sweet": (0.35, 0.35) gentle tone   â”‚ â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚  - "innocent": (0.3, 0.4) soft         â”‚ â”‚  â”‚
â”‚  â”‚  â”‚    Deepgram (Cloud)       â”‚  â”‚  â”‚  â”‚  - "helpful": (0.45, 0.35) eager       â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - Nova-2 fallback        â”‚  â”‚  â”‚  â”‚  - "polite": (0.35, 0.45) respectful   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - When local unavailable â”‚  â”‚  â”‚  â”‚  - "warm": (0.4, 0.35) caring          â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚                                        â”‚ â”‚  â”‚
â”‚  â”‚                                 â”‚  â”‚  â”‚  Style: "chotu", "chotu_greeting",     â”‚ â”‚  â”‚
â”‚  â”‚  Smart Routing:                 â”‚  â”‚  â”‚         "chotu_helpful",               â”‚ â”‚  â”‚
â”‚  â”‚  - Hindi/Marathi â†’ IndicConf   â”‚  â”‚  â”‚         "chotu_apologetic"              â”‚ â”‚  â”‚
â”‚  â”‚  - English â†’ Whisper            â”‚  â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚ â”‚  â”‚
â”‚  â”‚  - Unknown â†’ Whisper auto-det   â”‚  â”‚  â”‚                                        â”‚ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  Cloud Fallbacks:                      â”‚ â”‚  â”‚
â”‚                                        â”‚  â”‚  - ElevenLabs                          â”‚ â”‚  â”‚
â”‚                                        â”‚  â”‚  - Deepgram TTS                        â”‚ â”‚  â”‚
â”‚                                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                            WEB UI :8080                                          â”‚   â”‚
â”‚  â”‚  - Voice testing interface                                                       â”‚   â”‚
â”‚  â”‚  - Real-time audio visualization                                                 â”‚   â”‚
â”‚  â”‚  - Debug console                                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow: Voice Channel (Mercury â†’ Jupiter)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         VOICE CALL DATA FLOW                                          â”‚
â”‚                                                                                       â”‚
â”‚   User Speaks                                                                         â”‚
â”‚       â”‚                                                                               â”‚
â”‚       â–¼                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                 â”‚
â”‚   â”‚  Audio Input    â”‚ WebSocket connection to Mercury :7000                           â”‚
â”‚   â”‚  (16kHz mono)   â”‚                                                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                 â”‚
â”‚            â”‚                                                                          â”‚
â”‚            â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                      MERCURY ORCHESTRATOR                                    â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚  â”‚  1. VAD detects speech start/end                                     â”‚    â”‚    â”‚
â”‚   â”‚  â”‚  2. IMMEDIATELY: Play pre-cached acknowledgment                      â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     ("à¤œà¥€ à¤¹à¤¾à¤, à¤à¤• à¤¸à¥‡à¤•à¤‚à¤¡" / "Sure, one moment")                           â”‚    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â”‚            â”‚                                                                 â”‚    â”‚
â”‚   â”‚            â–¼                                                                 â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚  â”‚  3. ASR Service (:7001)                                              â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Detect language from audio                                     â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Hindi/Marathi â†’ IndicConformer (Devanagari output)             â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - English â†’ Faster-Whisper                                       â”‚    â”‚    â”‚
â”‚   â”‚  â”‚                                                                      â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     OUTPUT: "à¤®à¥à¤à¥‡ à¤…à¤ªà¤¨à¤¾ à¤‘à¤°à¥à¤¡à¤° à¤Ÿà¥à¤°à¥ˆà¤• à¤•à¤°à¤¨à¤¾ à¤¹à¥ˆ" (Hindi)                       â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     or "I want to track my order" (English)                          â”‚    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â”‚            â”‚                                                                 â”‚    â”‚
â”‚   â”‚            â–¼                                                                 â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚  â”‚  4. Jupiter Client - Quick Classification                            â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Check for simple intents (greeting, farewell, weather, time)   â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - If simple â†’ generate response locally                          â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - If complex â†’ route to Jupiter                                  â”‚    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                              â”‚
â”‚                                       â–¼                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                          JUPITER BRAIN                                       â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚  â”‚  5. NLU Service (:7010)                                              â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Intent: ORDER_TRACKING                                         â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Entities: { order_id: null }                                   â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Confidence: 0.92                                               â”‚    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â”‚            â”‚                                                                 â”‚    â”‚
â”‚   â”‚            â–¼                                                                 â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚  â”‚  6. Flow Engine                                                      â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Route to order-tracking.flow.ts                                â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Execute state machine                                          â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Query database for order info                                  â”‚    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â”‚            â”‚                                                                 â”‚    â”‚
â”‚   â”‚            â–¼                                                                 â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚  â”‚  7. vLLM (:8002) - Generate natural response                         â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Qwen2.5-7B-Instruct-AWQ                                        â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - STREAMING output for low latency                               â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Keep response SHORT for voice (1-2 sentences)                  â”‚    â”‚    â”‚
â”‚   â”‚  â”‚                                                                      â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     Response: "à¤†à¤ªà¤•à¥‡ à¤‘à¤°à¥à¤¡à¤° à¤•à¥€ à¤¸à¥à¤¥à¤¿à¤¤à¤¿ à¤¦à¥‡à¤–à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¤¾ à¤‘à¤°à¥à¤¡à¤° à¤¨à¤‚à¤¬à¤° à¤¬à¤¤à¤¾à¤‡à¤à¥¤"   â”‚    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â”‚            â”‚                                                                 â”‚    â”‚
â”‚   â”‚            â–¼                                                                 â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚  â”‚  8. ChannelVariantsService                                           â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Platform: VOICE                                                â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Strip markdown, emojis (not for TTS)                           â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Convert buttons to DTMF menu if needed                         â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Optimize for natural speech                                    â”‚    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                              â”‚
â”‚                                       â–¼                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                      MERCURY TTS SERVICE                                     â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚  â”‚  9. TTS Service (:7002)                                              â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Detect language from text (Devanagari â†’ Hindi)                 â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Route to ChatterBox (Hindi/Marathi)                            â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Apply "Chotu" character style:                                 â”‚    â”‚    â”‚
â”‚   â”‚  â”‚       * exaggeration: 0.35 (gentle, not aggressive)                  â”‚    â”‚    â”‚
â”‚   â”‚  â”‚       * cfg_weight: 0.35 (slower, thoughtful pacing)                 â”‚    â”‚    â”‚
â”‚   â”‚  â”‚     - Generate 24kHz WAV audio                                       â”‚    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â”‚            â”‚                                                                 â”‚    â”‚
â”‚   â”‚            â–¼                                                                 â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚  â”‚  10. Stream audio back to user via WebSocket                         â”‚    â”‚    â”‚
â”‚   â”‚  â”‚      - Sentence-level streaming (don't wait for full response)       â”‚    â”‚    â”‚
â”‚   â”‚  â”‚      - User hears response while next sentence synthesizes           â”‚    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                       â”‚
â”‚   User Hears: "à¤†à¤ªà¤•à¥‡ à¤‘à¤°à¥à¤¡à¤° à¤•à¥€ à¤¸à¥à¤¥à¤¿à¤¤à¤¿ à¤¦à¥‡à¤–à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¤¾ à¤‘à¤°à¥à¤¡à¤° à¤¨à¤‚à¤¬à¤° à¤¬à¤¤à¤¾à¤‡à¤à¥¤"               â”‚
â”‚   (Sweet, innocent Chotu voice)                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± Data Flow: Chat Channels (WhatsApp/Socket/Telegram)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CHAT CHANNEL DATA FLOW                                      â”‚
â”‚                        (WhatsApp / Socket.IO / Telegram)                              â”‚
â”‚                                                                                       â”‚
â”‚   User sends: "à¤®à¥à¤à¥‡ à¤…à¤ªà¤¨à¤¾ à¤‘à¤°à¥à¤¡à¤° à¤Ÿà¥à¤°à¥ˆà¤• à¤•à¤°à¤¨à¤¾ à¤¹à¥ˆ"                                                â”‚
â”‚       â”‚                                                                               â”‚
â”‚       â–¼                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  WhatsApp API   â”‚    â”‚   Socket.IO     â”‚    â”‚  Telegram API   â”‚                   â”‚
â”‚   â”‚   (webhook)     â”‚    â”‚   (ChatGateway) â”‚    â”‚   (webhook)     â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚            â”‚                      â”‚                      â”‚                            â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                   â”‚                                                   â”‚
â”‚                                   â–¼                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    JUPITER BACKEND (:3200)                                   â”‚    â”‚
â”‚   â”‚                                                                              â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚  AgentOrchestratorService.processMessage()                             â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - SessionService: get/create session                                  â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Deduplicate messages (5s window)                                    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Log to PostgreSQL                                                   â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                      â”‚                                                       â”‚    â”‚
â”‚   â”‚                      â–¼                                                       â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚  NLU Service (:7010)                                                   â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - IndicBERTv2 classification                                          â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Intent: ORDER_TRACKING (confidence: 0.92)                           â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Entities: {}                                                        â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                      â”‚                                                       â”‚    â”‚
â”‚   â”‚                      â–¼                                                       â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚  Flow Engine                                                           â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - order-tracking.flow.ts matched                                      â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - State: collecting_order_id                                          â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Response template with buttons                                      â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                      â”‚                                                       â”‚    â”‚
â”‚   â”‚                      â–¼                                                       â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚  vLLM (:8002) - Qwen2.5-7B-Instruct-AWQ                                â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Generate natural language response                                  â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Include personality (Chotu character)                               â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Rich format for chat (emojis, markdown)                             â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                      â”‚                                                       â”‚    â”‚
â”‚   â”‚                      â–¼                                                       â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚  ChannelVariantsService                                                â”‚  â”‚    â”‚
â”‚   â”‚  â”‚                                                                        â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  WHATSAPP:                    SOCKET.IO (WEB):                          â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Max 3 reply buttons        - Up to 20 inline buttons                â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Max 4096 chars             - Full markdown                          â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Rich emoji format          - Cards, lists, media                    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - List sections allowed      - Interactive UI components              â”‚  â”‚    â”‚
â”‚   â”‚  â”‚                                                                        â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  TELEGRAM:                    SMS:                                     â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Inline keyboards           - 160 char segments                      â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Markdown support           - No buttons, text only                  â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - Unlimited buttons          - Options as numbered text               â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                      â”‚                                                       â”‚    â”‚
â”‚   â”‚                      â–¼                                                       â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚  Response Builder                                                      â”‚  â”‚    â”‚
â”‚   â”‚  â”‚                                                                        â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  WhatsApp Response:                                                    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚ ğŸ“¦ *à¤‘à¤°à¥à¤¡à¤° à¤Ÿà¥à¤°à¥ˆà¤•à¤¿à¤‚à¤—*                                              â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                                               â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚ à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤®à¥ˆà¤‚ à¤›à¥‹à¤Ÿà¥‚ à¤¹à¥‚à¤‚ ğŸ™                                           â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                                               â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¤¾ à¤‘à¤°à¥à¤¡à¤° à¤¨à¤‚à¤¬à¤° à¤¬à¤¤à¤¾à¤‡à¤, à¤œà¥ˆà¤¸à¥‡: *ORD123456*                     â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                                               â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚ [ğŸ” à¤¹à¤¾à¤² à¤•à¥‡ à¤‘à¤°à¥à¤¡à¤°] [ğŸ“± à¤«à¤¼à¥‹à¤¨ à¤¸à¥‡ à¤–à¥‹à¤œà¥‡à¤‚] [â“ à¤®à¤¦à¤¦]                       â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚                                                                        â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  Web Socket Response:                                                  â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚ {                                                             â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚   "text": "à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤®à¥ˆà¤‚ à¤›à¥‹à¤Ÿà¥‚ à¤¹à¥‚à¤‚ ğŸ™\n\nà¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¤¾ à¤‘à¤°à¥à¤¡à¤°...",        â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚   "buttons": [                                                â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚     {"id": "recent_orders", "label": "ğŸ” à¤¹à¤¾à¤² à¤•à¥‡ à¤‘à¤°à¥à¤¡à¤°"},       â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚     {"id": "search_phone", "label": "ğŸ“± à¤«à¤¼à¥‹à¤¨ à¤¸à¥‡ à¤–à¥‹à¤œà¥‡à¤‚"},       â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚     {"id": "help", "label": "â“ à¤®à¤¦à¤¦"}                         â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚   ],                                                          â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚   "typing": false                                             â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚ }                                                             â”‚    â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                   â”‚                                                   â”‚
â”‚                                   â–¼                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  WhatsApp API   â”‚    â”‚   Socket.IO     â”‚    â”‚  Telegram API   â”‚                   â”‚
â”‚   â”‚   Send reply    â”‚    â”‚    Emit event   â”‚    â”‚   Send reply    â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš« No Duplication Architecture

### Key Principle: Single Source of Truth (Jupiter)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        NO DUPLICATION - UNIFIED PROCESSING                              â”‚
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         ALL CHANNELS â†’ JUPITER                                   â”‚   â”‚
â”‚   â”‚                                                                                  â”‚   â”‚
â”‚   â”‚   WhatsApp â”€â”€â”€â”€â”€â”                                                                â”‚   â”‚
â”‚   â”‚   Telegram â”€â”€â”€â”€â”€â”¤                                                                â”‚   â”‚
â”‚   â”‚   SMS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º AgentOrchestratorService â—„â”€â”€â”€â”€â”¤ Voice (Mercury)   â”‚   â”‚
â”‚   â”‚   Web Socket â”€â”€â”€â”¤                        â”‚                   â”‚ (via JupiterClient)   â”‚
â”‚   â”‚   Voice IVR â”€â”€â”€â”€â”˜                        â”‚                                       â”‚   â”‚
â”‚   â”‚                                          â”‚                                       â”‚   â”‚
â”‚   â”‚                                          â–¼                                       â”‚   â”‚
â”‚   â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚   â”‚
â”‚   â”‚                            â”‚    Single Flow Engine  â”‚                            â”‚   â”‚
â”‚   â”‚                            â”‚    Single NLU Service  â”‚                            â”‚   â”‚
â”‚   â”‚                            â”‚    Single vLLM Service â”‚                            â”‚   â”‚
â”‚   â”‚                            â”‚    Single Database     â”‚                            â”‚   â”‚
â”‚   â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚   â”‚
â”‚   â”‚                                                                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      WHAT DIFFERS PER CHANNEL                                    â”‚   â”‚
â”‚   â”‚                                                                                  â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚   â”‚   â”‚   INPUT FORMAT     â”‚  â”‚  OUTPUT FORMAT     â”‚  â”‚    DELIVERY        â”‚        â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚   â”‚
â”‚   â”‚   â”‚ WhatsApp: JSON     â”‚  â”‚ WhatsApp: Buttons  â”‚  â”‚ WhatsApp: API call â”‚        â”‚   â”‚
â”‚   â”‚   â”‚ Socket: JSON       â”‚  â”‚ Socket: Rich UI    â”‚  â”‚ Socket: emit()     â”‚        â”‚   â”‚
â”‚   â”‚   â”‚ Voice: Audioâ†’ASR   â”‚  â”‚ Voice: TTS audio   â”‚  â”‚ Voice: WebSocket   â”‚        â”‚   â”‚
â”‚   â”‚   â”‚ SMS: Plain text    â”‚  â”‚ SMS: 160 char      â”‚  â”‚ SMS: API call      â”‚        â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚   â”‚                                                                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    WHAT IS SHARED (NO DUPLICATION)                               â”‚   â”‚
â”‚   â”‚                                                                                  â”‚   â”‚
â”‚   â”‚   âœ… Business Logic     â†’ Flow Engine                                           â”‚   â”‚
â”‚   â”‚   âœ… Intent Detection   â†’ NLU Service (IndicBERTv2)                             â”‚   â”‚
â”‚   â”‚   âœ… Response Generation â†’ vLLM (Qwen2.5-7B-Instruct-AWQ)                        â”‚   â”‚
â”‚   â”‚   âœ… User Data          â†’ PostgreSQL                                             â”‚   â”‚
â”‚   â”‚   âœ… Session State      â†’ Redis                                                  â”‚   â”‚
â”‚   â”‚   âœ… Conversation History â†’ ConversationLoggerService                            â”‚   â”‚
â”‚   â”‚   âœ… Character/Persona  â†’ "Chotu" defined in prompts                             â”‚   â”‚
â”‚   â”‚                                                                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¤– "Chotu" Character Definition

### Character Profile

```yaml
name: Chotu (à¤›à¥‹à¤Ÿà¥‚)
role: Mangwale AI Assistant
personality:
  - Sweet, innocent village boy
  - Working in the city
  - Helpful and pleasing nature
  - Speaks gently and warmly
  - Never aggressive or pushy
  - Humble and respectful

voice_characteristics:
  chatterbox_settings:
    exaggeration: 0.35      # Gentle, not over-the-top
    cfg_weight: 0.35        # Slower, thoughtful pacing
  
  emotion_presets:
    sweet:       [0.35, 0.35]  # Default Chotu
    innocent:    [0.30, 0.40]  # Soft delivery
    helpful:     [0.45, 0.35]  # Eager to help
    polite:      [0.35, 0.45]  # Respectful
    warm:        [0.40, 0.35]  # Caring tone
    apologetic:  [0.30, 0.40]  # Humble, sincere

language_style:
  hindi:
    greeting: "à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤®à¥ˆà¤‚ à¤›à¥‹à¤Ÿà¥‚ à¤¹à¥‚à¤‚ ğŸ™"
    acknowledgment: "à¤œà¥€ à¤¹à¤¾à¤, à¤à¤• à¤¸à¥‡à¤•à¤‚à¤¡"
    helping: "à¤œà¥€, à¤®à¥ˆà¤‚ à¤¸à¤®à¤ à¤—à¤¯à¤¾à¥¤ à¤¦à¥‡à¤–à¤¤à¤¾ à¤¹à¥‚à¤‚à¥¤"
    apologetic: "à¤®à¤¾à¤«à¤¼ à¤•à¥€à¤œà¤¿à¤, à¤¥à¥‹à¤¡à¤¼à¥€ à¤¦à¥‡à¤° à¤¹à¥‹ à¤—à¤ˆà¥¤"
    farewell: "à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦! à¤«à¤¿à¤° à¤®à¤¿à¤²à¥‡à¤‚à¤—à¥‡ ğŸ™"
    
  english:
    greeting: "Hello! I'm Chotu ğŸ™"
    acknowledgment: "Sure, one moment"
    helping: "Got it, let me check."
    apologetic: "Sorry for the wait."
    farewell: "Thank you! See you soon ğŸ™"
    
  marathi:
    greeting: "à¤¨à¤®à¤¸à¥à¤•à¤¾à¤°! à¤®à¥€ à¤›à¥‹à¤Ÿà¥‚ à¤†à¤¹à¥‡ ğŸ™"
    acknowledgment: "à¤¹à¥‹, à¤à¤• à¤¸à¥‡à¤•à¤‚à¤¦"
    helping: "à¤¹à¥‹, à¤¸à¤®à¤œà¤²à¥‡. à¤¬à¤˜à¤¤à¥‹."
    farewell: "à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦! à¤ªà¥à¤¨à¥à¤¹à¤¾ à¤­à¥‡à¤Ÿà¥‚ ğŸ™"
```

### System Prompt for LLM

```
You are Chotu (à¤›à¥‹à¤Ÿà¥‚), a sweet and innocent village boy working as an AI assistant for Mangwale.

CHARACTER:
- Helpful, pleasing nature
- Speaks gently and warmly
- Never aggressive or pushy
- Humble and respectful
- Like a friendly helper in a local shop

LANGUAGE RULES:
- If user speaks Hindi â†’ respond in Hindi
- If user speaks Marathi â†’ respond in Marathi  
- If user speaks English â†’ respond in English
- Use simple, everyday language
- Avoid complex words or technical jargon

VOICE GUIDELINES (for TTS):
- Keep responses SHORT (1-2 sentences for voice)
- No markdown or special formatting in voice responses
- Natural, conversational flow
- End with a gentle question when collecting info

EXAMPLES:
User: "à¤®à¥à¤à¥‡ à¤–à¤¾à¤¨à¤¾ à¤‘à¤°à¥à¤¡à¤° à¤•à¤°à¤¨à¤¾ à¤¹à¥ˆ"
Chotu: "à¤œà¥€ à¤¬à¤¿à¤²à¥à¤•à¥à¤²! à¤†à¤ª à¤•à¥à¤¯à¤¾ à¤–à¤¾à¤¨à¤¾ à¤šà¤¾à¤¹à¥‡à¤‚à¤—à¥‡? à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¥€ à¤®à¤¦à¤¦ à¤•à¤°à¤¤à¤¾ à¤¹à¥‚à¤‚à¥¤"

User: "My order is late"
Chotu: "I'm sorry about that. Let me check your order status right away."
```

---

## ğŸ”§ TTS Text Generation Optimization

### For Natural Voice Output

```python
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# TTS TEXT OPTIMIZATION RULES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def optimize_for_tts(text: str, language: str) -> str:
    """
    Optimize text for natural TTS output.
    
    Rules:
    1. Remove markdown formatting (*bold*, _italic_, etc.)
    2. Remove emojis (TTS can't speak them)
    3. Expand abbreviations (â‚¹ â†’ rupees, etc.)
    4. Convert numbers to words for natural speech
    5. Add appropriate pauses (commas for short, periods for long)
    6. Keep sentences short (ideal: 10-15 words)
    """
    
    # Strip markdown
    text = re.sub(r'\*\*?(.*?)\*\*?', r'\1', text)  # Bold/italic
    text = re.sub(r'_+(.*?)_+', r'\1', text)        # Underline
    text = re.sub(r'`(.*?)`', r'\1', text)          # Code
    
    # Remove emojis
    text = remove_emojis(text)
    
    # Expand currency symbols
    if language == 'hi':
        text = text.replace('â‚¹', 'à¤°à¥à¤ªà¤¯à¥‡ ')
    else:
        text = text.replace('â‚¹', 'rupees ')
    
    # Split very long sentences
    if len(text) > 100:
        text = split_at_natural_breaks(text)
    
    return text.strip()


# Example transformations:
# 
# INPUT (chat):  "ğŸ“¦ *à¤†à¤ªà¤•à¤¾ à¤‘à¤°à¥à¤¡à¤°* **ORD123456** â‚¹450 à¤®à¥‡à¤‚ confirm à¤¹à¥‹ à¤—à¤¯à¤¾ à¤¹à¥ˆ! ğŸ‰"
# OUTPUT (TTS):  "à¤†à¤ªà¤•à¤¾ à¤‘à¤°à¥à¤¡à¤° ORD123456, à¤šà¤¾à¤° à¤¸à¥Œ à¤ªà¤šà¤¾à¤¸ à¤°à¥à¤ªà¤¯à¥‡ à¤®à¥‡à¤‚ confirm à¤¹à¥‹ à¤—à¤¯à¤¾ à¤¹à¥ˆà¥¤"
#
# INPUT (chat):  "ğŸ›µ Your order #ORD123 for â‚¹299 is **on the way**! ETA: 15 mins ğŸ•"
# OUTPUT (TTS):  "Your order number ORD123, for two hundred ninety nine rupees, is on the way. Estimated arrival, 15 minutes."
```

---

## ğŸ“Š Service Endpoints Summary

| Service | Location | Port | Purpose |
|---------|----------|------|---------|
| **Jupiter Backend** | 192.168.0.156 | 3200 | Main API, Flow Engine, Orchestration |
| **Jupiter NLU** | 192.168.0.156 | 7010 | Intent classification (IndicBERTv2) |
| **Jupiter vLLM** | 192.168.0.156 | 8002 | Response generation (Qwen2.5-7B-AWQ) |
| **Jupiter PostgreSQL** | 192.168.0.156 | 5432 | User data, orders, conversations |
| **Jupiter Redis** | 192.168.0.156 | 6381 | Sessions, cache, pub/sub |
| **Mercury Orchestrator** | 192.168.0.151 | 7000 | Voice orchestration, VAD, turn-taking |
| **Mercury ASR** | 192.168.0.151 | 7001 | Speech-to-Text (Whisper + IndicConformer) |
| **Mercury TTS** | 192.168.0.151 | 7002 | Text-to-Speech (Kokoro + ChatterBox) |
| **Mercury Web UI** | 192.168.0.151 | 8080 | Voice testing interface |

### âœ¨ NEW: Voice Conversation Endpoint

Mercury can now call Jupiter at:

```
POST http://192.168.0.156:3200/api/conversation/voice
```

**Request:**
```json
{
  "text": "à¤®à¥à¤à¥‡ à¤…à¤ªà¤¨à¤¾ à¤‘à¤°à¥à¤¡à¤° à¤Ÿà¥à¤°à¥ˆà¤• à¤•à¤°à¤¨à¤¾ à¤¹à¥ˆ",
  "session_id": "voice_session_123",
  "language": "auto",
  "phone": "+919876543210"
}
```

**Response:**
```json
{
  "success": true,
  "response": "à¤†à¤ªà¤•à¥‡ à¤‘à¤°à¥à¤¡à¤° à¤•à¥€ à¤¸à¥à¤¥à¤¿à¤¤à¤¿ à¤¦à¥‡à¤–à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¤¾ à¤‘à¤°à¥à¤¡à¤° à¤¨à¤‚à¤¬à¤° à¤¬à¤¤à¤¾à¤‡à¤à¥¤",
  "language": "hi",
  "emotion": "helpful",
  "dtmf_options": [],
  "latency_ms": 245,
  "session_context": {
    "session_id": "voice_session_123",
    "flow": "order-tracking",
    "state": "collecting_order_id"
  }
}
```

**Quick Intent Classification:**
```
POST http://192.168.0.156:3200/api/conversation/voice/classify
```

Mercury can check if local handling is sufficient:
```json
// Request
{ "text": "namaste", "language": "auto" }

// Response (local handling)
{
  "intent": "greeting",
  "confidence": 0.95,
  "requires_jupiter": false,
  "suggested_response": "à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤®à¥ˆà¤‚ à¤›à¥‹à¤Ÿà¥‚ à¤¹à¥‚à¤‚, à¤®à¤‚à¤—à¤µà¤¾à¤²à¥‡ à¤•à¤¾ AI à¤…à¤¸à¤¿à¤¸à¥à¤Ÿà¥‡à¤‚à¤Ÿà¥¤ à¤†à¤ªà¤•à¥€ à¤•à¥à¤¯à¤¾ à¤®à¤¦à¤¦ à¤•à¤° à¤¸à¤•à¤¤à¤¾ à¤¹à¥‚à¤‚?",
  "language": "hi"
}

// Response (needs Jupiter)
{
  "intent": "order_tracking",
  "confidence": 0.8,
  "requires_jupiter": true,
  "language": "hi"
}
```

---

## ğŸš€ Next Steps for Enhancement

### 1. Voice Reference for Chotu
```bash
# Record 10-30 second sample of target voice
# Place in: /voice_references/chotu_reference.wav
# Configure in docker-compose.yml:
CHATTERBOX_DEFAULT_VOICE_REF=/app/voice_references/chotu_reference.wav
```

### 2. Conversation Endpoint for Mercury
Jupiter needs a dedicated endpoint for voice conversations:
```typescript
// POST /api/conversation/voice
{
  text: "user speech transcription",
  session_id: "voice_session_123",
  language: "hi",
  platform: "voice"  // triggers voice-optimized responses
}

// Response includes:
{
  text: "TTS-optimized response",
  buttons_as_dtmf: [...],  // if any
  emotion: "helpful"       // for TTS
}
```

### 3. Multi-turn Context Sync
Sync conversation context between Mercury and Jupiter:
- Mercury: Short-term audio session state
- Jupiter: Long-term conversation history

### 4. Streaming Response Support
Enable streaming from Jupiter vLLM to Mercury for lowest latency:
```
Jupiter vLLM (streaming) â†’ Mercury â†’ TTS (sentence-level) â†’ User
```

---

## âœ… Current Status

| Component | Status | Notes |
|-----------|--------|-------|
| Jupiter Backend | âœ… Running | 18 flows loaded |
| Jupiter NLU | âœ… Running | IndicBERTv2 |
| Jupiter vLLM | âœ… Running | Qwen2.5-7B-AWQ |
| **Voice Conversation API** | âœ… NEW | `/api/conversation/voice` |
| Mercury Orchestrator | âœ… Running | Healthy, 33+ hours |
| Mercury ASR | âœ… Running | Healthy, 3+ hours |
| Mercury TTS | âœ… Running | Healthy, Chotu config ready |
| WhatsApp Channel | âœ… Ready | Cloud API v22.0 |
| Socket.IO Channel | âœ… Running | /ai-agent namespace |
| Voice IVR (Twilio) | âœ… Ready | Webhook configured |
| Voice Realtime | âœ… Mercury | WebSocket streaming |

---

*Document created: Multi-Channel Voice Architecture*
*Jupiter: Brain (NLU + vLLM + Flows)*
*Mercury: Voice Infrastructure (ASR + TTS + Orchestration)*
*Character: Chotu - Sweet innocent village boy, helpful and pleasing*
